<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:p="http://primefaces.org/ui">
<h:head>

</h:head>

<h:body>

<h:form id="form">
<p:dashboard model="#{adminDashboard.model}">

  <p:panel id="Domains" header="Domains">
    <p:selectOneListbox id="domainList" value="#{userList.model.selectedDomain}">
      <f:selectItems value="#{userList.existingDomains}"/>
    </p:selectOneListbox>
    <p:commandButton value="New domain" onclick="newDomainDlg.show();"/>
  </p:panel>
  
  <p:panel id="Users" header="Users">
    <p:contextMenu for="userList">
	    <p:menuitem value="Modify" update="userList" icon="ui-icon-search" oncomplete="newUserDlg.show()"/>
	    <p:menuitem value="Delete" update="userList" icon="ui-icon-close" onclick="confirmation.show()"/>
    </p:contextMenu>
	  <p:confirmDialog id="confirmDeleteDialog" message="Are you sure you want to remove the selected user?"
	        header="Delete user" severity="alert" widgetVar="confirmation">
	        
	    <p:commandButton id="confirm" value="Yes" update=":form:userList, :messages" oncomplete="confirmation.hide()"
	          actionListener="#{userList.deleteUser}" />
	    <p:commandButton id="decline" value="Not" onclick="confirmation.hide()" type="button" /> 
	        
	  </p:confirmDialog>
		<p:dataTable
		  id="userList"
		  var="user"
		  value="#{userList.model}"
		  selection="#{userList.selectedUser}"
		  selectionMode="single"
		  rowKey="#{user.id}"
		  paginator="true"
		  rows="10">
      <p:column
        headerText="Domain"
        filterBy="#{user.domain}"
        filterOptions="#{userList.availableDomains}"
        filterMatchMode="exact"
      >
        <h:outputText value="#{user.domain}" />
      </p:column>
	    <p:column
        headerText="Login"
        filterBy="#{user.login}"
        filterMatchMode="contains"
	    >
	      <h:outputText value="#{user.login}" />
	    </p:column>
      <p:column
        headerText="Name"
        filterBy="#{user.name}"
        filterMatchMode="contains"
      >
        <h:outputText value="#{user.name}" />
      </p:column>
      <p:column
        headerText="Email"
        filterBy="#{user.email}"
        filterMatchMode="contains"
      >
        <h:outputText value="#{user.email}" />
      </p:column>
	  </p:dataTable>
	  <p:commandButton value="New user" onclick="newUserDlg.show();"/>
  </p:panel>
  <p:panel id="Groups" header="Groups">
    <h:outputText value="Groups Content" />
    <p:dataTable
      id="groupList"
      var="group"
      value="#{groupList.model}"
      selection="#{groupList.selectedGroup}"
      selectionMode="single"
      rowKey="#{group.id}"
      paginator="true"
      rows="10">
      <p:column
        headerText="Domain"
        filterBy="#{group.domain}"
        filterOptions="#{groupList.availableDomains}"
        filterMatchMode="exact"
      >
        <h:outputText value="#{group.domain}" />
      </p:column>
      <p:column
        headerText="Name"
        filterBy="#{group.name}"
        filterMatchMode="contains"
      >
        <h:outputText value="#{group.name}" />
      </p:column>
    </p:dataTable>
    <p:commandButton value="New group" onclick="newGroupDlg.show();"/>
  </p:panel>
</p:dashboard>

</h:form>

 <p:dialog id="domainDlg" header="New domain" widgetVar="newDomainDlg" modal="true" height="100">
  <h:form id="formdomain">

    <h:panelGrid columns="2" style="margin-bottom:10px">
      <h:outputLabel for="name" value="name" />
      <p:inputText id="name" required="true" value="#{domain.name}">
        <f:validateLength minimum="2" />
      </p:inputText>
    </h:panelGrid>

    <p:commandButton id="submitButtonDomain" value="Submit" actionListener="#{domain.save}" update=":form:domainList, :messages" oncomplete="newDomainDlg.hide();"/>
      
  </h:form>
 </p:dialog> 
 <p:dialog id="userDlg" header="New user" widgetVar="newUserDlg" modal="true" height="250">  
  <h:form id="formuser">

    <h:panelGrid columns="2" style="margin-bottom:10px">
    
			<h:outputText for="udomain" value="Domain" />  
      <p:selectOneMenu id="udomain" value="#{user.domain}">
        <f:selectItems value="#{userList.existingDomains}"/>
      </p:selectOneMenu>  
      <h:outputLabel for="ulogin" value="login" />
      <p:inputText id="ulogin" required="true" value="#{user.login}">
        <f:validateLength minimum="2" />
      </p:inputText>
      <h:outputLabel for="uname" value="name" />
      <p:inputText id="uname" required="true" value="#{user.name}">
        <f:validateLength minimum="2" />
      </p:inputText>
      <h:outputLabel for="upwd" value="password" />
      <p:inputText id="upwd" required="true" value="#{user.pwd}">
        <f:validateLength minimum="4" />
      </p:inputText>
      <h:outputLabel for="uemail" value="email" />
      <p:inputText id="uemail" required="true" value="#{user.email}">
      </p:inputText>
    </h:panelGrid>

    <p:commandButton id="submitButtonUser" value="Submit" actionListener="#{user.save}" update=":form:userList, :messages" oncomplete="newUserDlg.hide();"/>
      
  </h:form>
 </p:dialog> 
 <p:dialog id="groupDlg" header="New group" widgetVar="newGroupDlg" modal="true" height="250">  
  <h:form id="formgroup">

    <h:panelGrid columns="2" style="margin-bottom:10px">
    
      <h:outputText for="gdomain" value="Domain" />  
      <p:selectOneMenu id="gdomain" value="#{group.domain}">
        <f:selectItems value="#{groupList.domains}"/>
      </p:selectOneMenu>
      <h:outputLabel for="gname" value="name" />
      <p:inputText id="gname" required="true" value="#{group.name}">
        <f:validateLength minimum="2" />
      </p:inputText>
    </h:panelGrid>

    <p:commandButton id="submitButtonGroup" value="Submit" actionListener="#{group.save}" update=":form:groupList, :messages" oncomplete="newGroupDlg.hide();"/>
      
  </h:form>
 </p:dialog> 

<p:growl id="messages" />
</h:body>
</html>
